<html>
<script>
var fsdMassNew;
var massOptimalNew;
var maxFuelNew;

var massEmpty;
var massFull;
var fsdR;
var fsdC;
var fsdFuel;
var massOptimal;
var fsdMass;

function giveresult() {
	massEmpty = parseFloat(document.getElementById("iEmptyM").value) || 0;
	massFull = parseFloat(document.getElementById("iFullM").value) || massEmpty;
	massOptimal = parseFloat(document.getElementById("iOptiM").value) || 0;
	fsdR = document.getElementById("iR").value;
	fsdC = parseFloat(document.getElementById("iC").value) || 2;
	fsdFuel = parseFloat(document.getElementById("iFsdF").value) || 0;
	fsdMass = parseFloat(document.getElementById("iFsdM").value) || 0;
	var fsdMassMod = parseFloat(document.getElementById("mFsdM").value)/100 || 0;
	var massOptimalMod = parseFloat(document.getElementById("mOptiM").value)/100 || 0;
	var maxFuelMod = parseFloat(document.getElementById("mFsdF").value)/100 || 0;

	var fsdMassChange=fsdMassMod*fsdMass;
	fsdMassNew = fsdMass+fsdMassChange;
	var massEmptyNew=massEmpty+fsdMassChange;
	var massFullNew=massFull+fsdMassChange;
	var massOptimalChange=massOptimalMod*massOptimal;
	massOptimalNew = massOptimal+massOptimalChange;
	var maxFuelChange=fsdFuel*maxFuelMod;
	maxFuelNew=fsdFuel+maxFuelChange;
	var fsdE = ((fsdC-2)*0.15)+2;
	var fsdM = 0.01;
	switch(fsdR) {
		case "a" :
		case "A" :
			fsdM = 0.012;
			break;
		case "b" :
		case "B" :
		case "d" :
		case "D" :
			fsdM = 0.01;
			break;
		case "c" :
		case "C" :
			fsdM = 0.08;
			break;
		case "e" :
		case "E" :
			fsdM = 0.011;
			break;
		default :
			fsdM = 0.01;
			break;
	}

	var a = massOptimal/massEmpty;
	var b = massOptimal/massFull;

	var aa = massOptimalNew/massEmptyNew;
	var ab = massOptimalNew/massFullNew;

	var ba = aa/a;
	var bb = ab/b;

	var z = Math.pow(maxFuelNew/fsdM, 1/fsdE);
	var za = z*a;
	var zb = z*b;
	var zaa = z*aa;
	var zab = z*ab;

	var xa = (zaa-za)/za*100;
	var xb = (zab-zb)/zb*100;

	var ra = document.getElementById("currentRange");
	ra.innerHTML= "Current Jump Range (Empty) = "+za;
	var rb = document.getElementById("currentRangeFull");
	rb.innerHTML= "Current Jump Range (Full) = "+zb;

	var r0 = document.getElementById("newRange");
	r0.innerHTML= "New Estimated Jump Range (Empty) = "+zaa;
	var r1 = document.getElementById("newRangeFull");
	r1.innerHTML= "New Estimated Jump Range (Full) = "+zab;

	/*--------------- Optimal Mass to Mass Ratios -----------
	var r2 = document.getElementById("emptyoptimassratio");
	r2.innerHTML= "Current optimalMass/emptyMass ratio = "+a;
	var r3 = document.getElementById("newemptyoptimassratio");
	r3.innerHTML= "Upgraded optimalMass/emptyMass ratio = "+aa;

	var r4 = document.getElementById("fulloptimassratio");
	r4.innerHTML= "Current optimalMass/fullMass ratio = "+b;
	var r5 = document.getElementById("newfulloptimassratio");
	r5.innerHTML= "Upgraded optimalMass/fullMass ratio = "+ab;

	var r6 = document.getElementById("emptyratioupgrade");
	r6.innerHTML= "empty ratio upgrade = "+ba;
	var r7 = document.getElementById("fullratioupgrade");
	r7.innerHTML= "full upgrade ratio = "+bb;
	------------------------------------------------------*/
	
	var r8 = document.getElementById("RangeIncrease");
	r8.innerHTML= "empty range increase (%) = "+xa;
	var r9 = document.getElementById("RangeIncreaseFull");
	r9.innerHTML= "full range increase (%) = "+xb;
}

function applyChange () {
	document.getElementById("iFsdF").value = maxFuelNew;
	document.getElementById("iFsdM").value = fsdMassNew;
	document.getElementById("iOptiM").value = massOptimalNew;
	document.getElementById("mFsdM").value = 0;
	document.getElementById("mOptiM").value = 0;
	document.getElementById("mFsdF").value = 0;
}

function storeStats () {
	document.cookie = "iEmptyM="+massEmpty+";"+"iFullM="+massFull+";"+"iOptiM="+massOptimal+";"+"iR="+fsdR+";"+"iC="+fsdC+";"+"iFsdF="+fsdFuel+";"+"iFsdM="+massEmpty+";"+";expires=Tue, 19 Jan 2038 03:14:07 UTC;path=/";
}

function loadStats () {
	var cookieArray = document.cookie.split(';');
	for (var i=0; i<cookieArray.Length-2; i++) {
		var cookieArrayInfo = cookieArray[i];
		var cookieArrayInfoArray = cookieArrayInfo.split('=');
		var cookieArrayInfoTitle = String(cookieArrayInfoArray[0]);
		var cookieArrayInfoValue;
		if (i = 3) {
			cookieArrayInfoValue = String(cookieArrayInfoArray[1]);
		} else {
			cookieArrayInfoValue = parseFloat(cookieArrayInfoArray[1]);
		}
		document.getElementById(cookieArrayInfoTitle).value = cookieArrayInfoValue;
	}
}

function clearStats () {
	//todo
}

</script>

<body>
	Mass Empty : <input type="text" name="Empty" id="iEmptyM" /><br>
	Mass Full : <input type="text" name="Full" id="iFullM" /> <span class="darktext">if blank = empty</span><br><br>
	FSD Rating : <input type="text" name="fsdR" id="iR" /> <span class="darktext">A-E (not case sensitive)</span><br>
	FSD Class : <input type="text" name="fsdC" id="iC" /> <span class="darktext">2 and up</span><br>
	FSD Max Fuel : <input type="text" name="FSDfuel" id="iFsdF" /><br>
	FSD Optimal Mass : <input type="text" name="Optimal" id="iOptiM" /><br>
	FSD Mass : <input type="text" name="FSDMass" id="iFsdM" /><br><br>
	FSD Mass Mod (%) : <input type="text" name="FSDMassMod" id="mFsdM" /> <span class="darktext">+ if mod increases mass, - if it decreases</span><br>
	FSD Optimal Mass Mod (%) : <input type="text" name="FSDOptimalMassMod" id="mOptiM" /><br>
	FSD Max Fuel Mod (%) : <input type="text" name="FSDMaxFuelMod" id="mFsdF" /><br><br>

	<input type="button" value="calcuate" onClick="giveresult()"><br><br>

	<p id="currentRange" class="darktext">current Range (Empty)</p>
	<p id="RangeIncrease" class="darktext">range increase (Empty)</p>
	<p id="newRange">new Range (Empty)</p>
	<p id="currentRangeFull" class="darktext">current Range (Full)</p>
	<p id="RangeIncreaseFull" class="darktext">range increase (Full)</p>
	<p id="newRangeFull">new Range (Full)</p><br>

	<!-- Optimal Mass to Mass Ratio
	<p id="emptyoptimassratio" class="darktext">OptimalMass/Mass ratio(Empty)
	<p id="newemptyoptimassratio" class="darktext">New OptimalMass/Mass ratio(Empty)</p>
	<p id="emptyratioupgrade" class="darktext"></p><br>
	<p id="fulloptimassratio" class="darktext">OptimalMass/Mass ratio(Full)</p>
	<p id="newfulloptimassratio" class="darktext">New OptimalMass/Mass ratio(Full)</p>
	<p id="fullratioupgrade" class="darktext"></p><br>
	-->

	<input type="button" value="Apply FSD Mod" onClick="applyChange()"> <input type="button" value="Save Ship Config" onClick="storeStats()"> <input type="button" value="Load Ship Config" onClick="loadStats()"><br><br>

	<p>
		<!-- <h3>Dafuq iz dis?</h3> -->
		<h3>About</h3>
		<p> As the title says, this is the FSD Mod Calculator. The ultimate tool for anyone who's upgrading their FSD with an engineer. It features state of the art text input fields, the most beautiful black background ever seen on the Internet, and a standard font. Never has the Internet been so enjoyable. <br>
		Simply enter the current stats of your craft (you can look them up in outfitting), then go to see what the Engineer has to offer, and punch their numbers in to the Mod fields. <br><br>
		I've found some inaccuracy around the 0.01 point, this might be due to Frontier rounding up values as they go along, and as you can see I don't round any part up... yet. I will do some testing and try to remove then inaccuracy.
		However, when compairing your currents stats to the stats of a possible mod, unless the change of range is of 0.01Ly, the calculator will tell you which is better even if it doesn't give the most accurate range.
		</p>

		<p> Credits: CMDR Myv.hs, a.k.a Pepys<br>
		Extra Credits to <a href="https://coriolis.io">Coriolis.io</a> and <a href="http://www.edshipyard.com">Elite Dangerous Shipyard</a>. Thx for the multiplier and exponential values, I wouldn't of found them without digging through your code. </p>

		<span class="darktext">
			Update 2:
			<ul>
				<li>added Apply Changes function</li>
				<li>commented out 'Optimal Mass to Mass ratio' (DL source and remove comment tags to return functionality)</li>
			</ul>
		</span>
		<span class="darktext"> 
			Update 1: 
			<ul>
				<li>added max fuel mod field</li>
				<li>added helpful text</li>
			</ul>
		</span>
	</p>

</body>
<style type="text/css">
body {
	background-color: black;
	color:white;
}
a {
	color:green;
}

.darktext {
	color:#757575;
}
</style>
</html>